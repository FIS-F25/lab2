# Token-Based Authentication

After you demolished the app security in exercise 1, the admin decided to implement the secure token-based authentication with JWTs.

The updated `app.py` now looks like this (no database involved):

```copy
from flask import Flask
from flask_httpauth import HTTPTokenAuth
from secrets import token_hex
import jwt


app = Flask(__name__)
auth = HTTPTokenAuth('Bearer')
app_secret = token_hex(2)

@auth.verify_token
def verify_token(token):
    try:
        data = jwt.decode(token, app_secret, algorithms=['HS256'])
    except:
        return False
    if data.get("admin", False):
        return "admin"


@app.route('/')
@auth.login_required
def index():
    return f"Hello, {auth.current_user()}"

if __name__ == '__main__':
    app.run()
```

## Exercise 3

- Run the application in one terminal.
- Hack it in the other (i.e., send a valid `curl` command that gets you logged in as admin).

Assume the attacker sees the above source code.

> Hint: you don't always have to waste time writing exploits, maybe there is an existing tool to help?
